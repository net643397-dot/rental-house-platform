# ğŸ  æˆ¿æºä¿¡æ¯å¹³å° - House Rental Platform

[![Flask](https://img.shields.io/badge/Flask-2.0+-green.svg)](https://flask.palletsprojects.com/)
[![MySQL](https://img.shields.io/badge/MySQL-8.0+-blue.svg)](https://www.mysql.com/)
[![License](https://img.shields.io/badge/License-MIT-yellow.svg)](LICENSE)
[![GitHub stars](https://img.shields.io/github/stars/net643397-dot/rental-house-platform?style=social)](https://github.com/net643397-dot/rental-house-platform/stargazers)
[![GitHub forks](https://img.shields.io/github/forks/net643397-dot/rental-house-platform?style=social)](https://github.com/net643397-dot/rental-house-platform/network)

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

ä¸€ä¸ªåŸºäºFlask + MySQLçš„ç°ä»£åŒ–**æˆ¿æºä¿¡æ¯å¹³å°**ï¼Œæ”¯æŒåœ°å›¾æ‰¾æˆ¿ã€æ™ºèƒ½æ¨èã€ç”¨æˆ·ç³»ç»Ÿç­‰å®Œæ•´åŠŸèƒ½ã€‚

### ğŸŒŸ æ ¸å¿ƒäº®ç‚¹
- ğŸ—ºï¸ **åœ°å›¾æ‰¾æˆ¿åŠŸèƒ½** - åŸºäºç™¾åº¦åœ°å›¾çš„å®æ—¶æˆ¿æºæœç´¢ä¸å¯è§†åŒ–
- ğŸ¤– **æ™ºèƒ½æ¨èç®—æ³•** - åŸºäºåŒºåŸŸ+ä»·æ ¼+æˆ¿å‹çš„ç›¸ä¼¼æˆ¿æºæ¨è
- ğŸ“± **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢ç«¯å’Œç§»åŠ¨ç«¯
- ğŸ”„ **åæ ‡è½¬æ¢æŠ€æœ¯** - BD-09ä¸GCJ-02åæ ‡ç³»ç²¾ç¡®è½¬æ¢
- ğŸ“Š **å¤§æ•°æ®å¤„ç†** - 113,318æ¡çœŸå®æˆ¿æºæ•°æ®ï¼Œé«˜æ€§èƒ½æŸ¥è¯¢

## ğŸŒŸ é¡¹ç›®ç‰¹æ€§

- ğŸ  **æˆ¿æºæœç´¢ä¸ç­›é€‰** - æ”¯æŒåŒºåŸŸã€ä»·æ ¼ã€æˆ¿å‹ã€ç§Ÿèµç±»å‹ç­‰å¤šç»´åº¦ç­›é€‰
- ğŸ“ **åœ°å›¾æ‰¾æˆ¿åŠŸèƒ½** - åŸºäºç™¾åº¦åœ°å›¾çš„å®æ—¶æˆ¿æºæœç´¢ä¸å¯è§†åŒ–
- â­ **æ™ºèƒ½æ¨èç³»ç»Ÿ** - åŸºäºåŒºåŸŸ+ä»·æ ¼+ç§Ÿèµç±»å‹çš„ç›¸ä¼¼æˆ¿æºæ¨è
- ğŸ” **é™„è¿‘æˆ¿æºç®—æ³•** - é«˜æ€§èƒ½çš„åœ°ç†ä½ç½®æœç´¢ä¸è·ç¦»è®¡ç®—
- ğŸ“Š **æ•°æ®å¯è§†åŒ–** - æˆ¿æºç»Ÿè®¡å›¾è¡¨ã€çƒ­åŠ›å›¾ã€èšåˆæ ‡è®°å±•ç¤º
- ğŸ‘¤ **ç”¨æˆ·ç³»ç»Ÿ** - æ³¨å†Œç™»å½•ã€æ”¶è—ç®¡ç†ã€æµè§ˆå†å²
- ğŸ“± **å“åº”å¼è®¾è®¡** - å®Œç¾é€‚é…æ¡Œé¢ç«¯ä¸ç§»åŠ¨ç«¯
- ğŸš€ **ä¸€é”®éƒ¨ç½²** - å®Œæ•´çš„æ‰“åŒ…åˆ†å‘æ–¹æ¡ˆä¸éƒ¨ç½²è„šæœ¬

## ğŸ“‹ æŠ€æœ¯æ ˆ

**åç«¯æ¡†æ¶**: Flask 2.0 + SQLAlchemy ORM
**æ•°æ®åº“**: MySQL 8.0+ (113,318æ¡çœŸå®æˆ¿æºæ•°æ®)
**å‰ç«¯æŠ€æœ¯**: Bootstrap 5 + JavaScript + ç™¾åº¦åœ°å›¾API
**åœ°å›¾æœåŠ¡**: ç™¾åº¦åœ°å›¾BD-09åæ ‡ç³» + GCJ-02åæ ‡è½¬æ¢
**éƒ¨ç½²å·¥å…·**: PyInstaller + ä¸€é”®åˆå§‹åŒ–è„šæœ¬

## å¿«é€Ÿå¼€å§‹

### æ–¹æ³•ä¸€ï¼šä½¿ç”¨ä¸€é”®å¯åŠ¨è„šæœ¬
```bash
# Windowsç”¨æˆ·
double-click start.bat

# æˆ–è€…åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ
start.bat
```

### æ–¹æ³•äºŒï¼šæ‰‹åŠ¨å¯åŠ¨
1. æŸ¥çœ‹è¯¦ç»†è¯´æ˜ï¼š[å¯åŠ¨æ“ä½œæŒ‡å—.md](å¯åŠ¨æ“ä½œæŒ‡å—.md)
2. æ£€æŸ¥ç³»ç»ŸçŠ¶æ€ï¼šè¿è¡Œ `quick_check.bat`

## åŠŸèƒ½ç‰¹æ€§

- ğŸ  æˆ¿æºæœç´¢ä¸ç­›é€‰
- ğŸ“ åœ°å›¾æ‰¾æˆ¿åŠŸèƒ½
- â­ æˆ¿æºæ”¶è—
- ğŸ“Š æµè§ˆå†å²
- ğŸ” æ™ºèƒ½æ¨è
- ğŸ“± å“åº”å¼è®¾è®¡

## ç³»ç»Ÿè¦æ±‚

- Python 3.9+
- Condaç¯å¢ƒç®¡ç†å™¨
- MySQLæ•°æ®åº“
- æˆ¿æºæ•°æ®æ–‡ä»¶ï¼ˆhouse.sqlï¼‰

## ğŸ“ é¡¹ç›®ç»“æ„

```
rental-house-platform/
â”œâ”€â”€ ğŸ“„ app.py                      # Flaskä¸»åº”ç”¨ (38KB)
â”œâ”€â”€ ğŸ“„ database.py                 # æ•°æ®åº“æ¨¡å‹ä¸é…ç½®
â”œâ”€â”€ ğŸ“„ location_utils.py           # åœ°ç†ä½ï¿½ï¿½å·¥å…·å‡½æ•° (Haversineç®—æ³•)
â”œâ”€â”€ ğŸ“„ coordinate_converter.py     # BD-09ä¸GCJ-02åæ ‡è½¬æ¢
â”œâ”€â”€ ğŸ“„ run_app.py                  # æ‰“åŒ…å…¥å£æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ house.sql                   # æˆ¿æºæ•°æ®æ–‡ä»¶ (65MB, 11ä¸‡+æ¡æ•°æ®)
â”œâ”€â”€ ğŸ“„ add_location_fields.sql     # æ•°æ®åº“ç»“æ„æ›´æ–°
â”œâ”€â”€ ğŸ“„ config.json                 # é…ç½®æ–‡ä»¶
â”œâ”€â”€ ğŸ“„ setup_mysql.bat             # ä¸€é”®æ•°æ®åº“åˆå§‹åŒ–è„šæœ¬
â”œâ”€â”€ ğŸ“„ start.bat                   # ä¸€é”®å¯åŠ¨è„šæœ¬
â”œâ”€â”€ ğŸ“„ quick_check.bat             # ç³»ç»ŸçŠ¶æ€æ£€æŸ¥
â”œâ”€â”€ ğŸ“„ amap_geocoding.py           # é«˜å¾·åœ°å›¾åœ°ç†ç¼–ç 
â”œâ”€â”€ ğŸ“„ map_house.spec              # PyInstalleræ‰“åŒ…é…ç½®
â”œâ”€â”€ ğŸ“ templates/                  # Jinja2 HTMLæ¨¡æ¿
â”‚   â”œâ”€â”€ index.html                 # æˆ¿æºåˆ—è¡¨é¡µ
â”‚   â”œâ”€â”€ house_detail.html          # æˆ¿æºè¯¦æƒ…é¡µ
â”‚   â”œâ”€â”€ map_search.html            # åœ°å›¾æ‰¾æˆ¿é¡µ
â”‚   â””â”€â”€ ...                        # å…¶ä»–æ¨¡æ¿
â”œâ”€â”€ ğŸ“ static/                     # é™æ€èµ„æº
â”‚   â”œâ”€â”€ css/                       # æ ·å¼æ–‡ä»¶
â”‚   â”œâ”€â”€ js/                        # JavaScriptæ–‡ä»¶
â”‚   â””â”€â”€ images/                    # å›¾ç‰‡èµ„æº
â”œâ”€â”€ ğŸ“ dist/                       # PyInstalleræ‰“åŒ…è¾“å‡º
â””â”€â”€ ğŸ“ docs/                       # æ–‡æ¡£ç›®å½•
    â”œâ”€â”€ å¯åŠ¨æ“ä½œæŒ‡å—.md
    â”œâ”€â”€ é¡¹ç›®åŠŸèƒ½åˆ—è¡¨.md
    â”œâ”€â”€ é¡¹ç›®äº®ç‚¹.md
    â””â”€â”€ é¡¹ç›®éš¾ç‚¹.md
```

## è®¿é—®åœ°å€

å¯åŠ¨æˆåŠŸåï¼Œé€šè¿‡ä»¥ä¸‹åœ°å€è®¿é—®ï¼š
- æœ¬åœ°ï¼šhttp://127.0.0.1:5000
- å±€åŸŸç½‘ï¼šhttp://[ä½ çš„IP]:5000

## æ•…éšœæ’é™¤

å¦‚æœé‡åˆ°é—®é¢˜ï¼š

1. **é¦–å…ˆè¿è¡Œç³»ç»Ÿæ£€æŸ¥**ï¼š
   ```bash
   quick_check.bat
   ```

2. **æŸ¥çœ‹è¯¦ç»†è§£å†³æ–¹æ¡ˆ**ï¼š
   å‚è€ƒ [å¯åŠ¨æ“ä½œæŒ‡å—.md](å¯åŠ¨æ“ä½œæŒ‡å—.md) ä¸­çš„"å¸¸è§é—®é¢˜è§£å†³"éƒ¨åˆ†

3. **å¸¸è§é—®é¢˜**ï¼š
   - MySQLè¿æ¥å¤±è´¥ â†’ æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€
   - æ— æˆ¿æºæ•°æ® â†’ é‡æ–°å¯¼å…¥house.sql
   - å­—æ®µé”™è¯¯ â†’ æ‰§è¡Œadd_location_fields.sql

## å¼€å‘ä¿¡æ¯

- **æ¡†æ¶**ï¼šFlask + SQLAlchemy
- **æ•°æ®åº“**ï¼šMySQL 9.3.0
- **å‰ç«¯**ï¼šBootstrap 5 + JavaScript
- **æ•°æ®é‡**ï¼š113,318æ¡æˆ¿æºè®°å½•

## ğŸ–¥ï¸ ç•Œé¢å±•ç¤ºä¸åŠŸèƒ½è¯¦è§£

### 1. æˆ¿æºåˆ—è¡¨é¡µ (é¦–é¡µ)
**ç•Œé¢å±•ç¤º**
![æˆ¿æºåˆ—è¡¨é¡µ](images/screenshots/index-screenshot.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **åˆ†é¡µå±•ç¤º**: æ”¯æŒæŒ‰é¡µæµè§ˆæˆ¿æºä¿¡æ¯ï¼Œæ¯é¡µæ˜¾ç¤ºå›ºå®šæ•°é‡æˆ¿æº
- **å¤šç»´åº¦ç­›é€‰**:
  - åŒºåŸŸç­›é€‰ï¼ˆæœé˜³åŒºã€æµ·æ·€åŒºã€ä¸°å°åŒºç­‰ï¼‰
  - ä»·æ ¼åŒºé—´ç­›é€‰ï¼ˆ1000-2000ã€2000-3000ç­‰ï¼‰
  - ç§Ÿèµç±»å‹ç­›é€‰ï¼ˆæ•´ç§Ÿã€åˆç§Ÿï¼‰
  - æˆ¿å‹ç­›é€‰ï¼ˆä¸€å®¤ã€ä¸¤å®¤ã€ä¸‰å®¤ç­‰ï¼‰
- **æ™ºèƒ½æ’åº**: æ”¯æŒæŒ‰ä»·æ ¼ã€é¢ç§¯ã€å‘å¸ƒæ—¶é—´æ’åº
- **å¿«é€Ÿé¢„è§ˆ**: é¼ æ ‡æ‚¬åœæ˜¾ç¤ºæˆ¿æºå…³é”®ä¿¡æ¯
- **å“åº”å¼å¸ƒå±€**: å®Œç¾é€‚é…æ¡Œé¢å’Œç§»åŠ¨è®¾å¤‡

**æŠ€æœ¯å®ç°**
```python
@app.route('/')
def index():
    page = request.args.get('page', 1, type=int)
    district = request.args.get('district', '')
    price_min = request.args.get('price_min', '', type=int)
    price_max = request.args.get('price_max', '', type=int)
    house_type = request.args.get('house_type', '')

    # æ„å»ºæŸ¥è¯¢æ¡ä»¶
    query = House.query
    if district:
        query = query.filter(House.district == district)
    if price_min:
        query = query.filter(House.price >= price_min)
    if price_max:
        query = query.filter(House.price <= price_max)
    if house_type:
        query = query.filter(House.house_type == house_type)

    # åˆ†é¡µæŸ¥è¯¢
    houses = query.paginate(page=page, per_page=20, error_out=False)
    districts = db.session.query(House.district).distinct().all()

    return render_template('index.html', houses=houses, districts=districts)
```

### 2. æˆ¿æºè¯¦æƒ…é¡µ
**ç•Œé¢å±•ç¤º**
![æˆ¿æºè¯¦æƒ…é¡µ1](images/screenshots/detail-screenshot-1.png)
![æˆ¿æºè¯¦æƒ…é¡µ2](images/screenshots/detail-screenshot-2.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **æˆ¿æºä¿¡æ¯å±•ç¤º**:
  - åŸºç¡€ä¿¡æ¯ï¼ˆé¢ç§¯ã€ä»·æ ¼ã€æ¥¼å±‚ã€æœå‘ç­‰ï¼‰
  - æˆ¿å±‹å›¾ç‰‡å±•ç¤ºè½®æ’­
  - é…å¥—è®¾æ–½æ ‡ç­¾å±•ç¤º
  - æˆ¿æºäº®ç‚¹æè¿°
  - å°åŒºä¿¡æ¯ä»‹ç»
- **äº¤äº’åŠŸèƒ½**:
  - æ”¶è—åŠŸèƒ½ï¼ˆéœ€ç™»å½•ï¼‰
  - æµè§ˆå†å²è®°å½•
  - åˆ†äº«åŠŸèƒ½
  - è”ç³»æ–¹å¼å±•ç¤º
- **ç›¸ä¼¼æˆ¿æºæ¨è**: åŸºäºåŒºåŸŸ+ä»·æ ¼+æˆ¿å‹æ™ºèƒ½æ¨è
- **æ•°æ®å¯è§†åŒ–**: æˆ¿æºç»Ÿè®¡å›¾è¡¨å±•ç¤º

**æ¨èç®—æ³•**
```python
@app.route('/api/similar-houses/<int:house_id>')
def similar_houses(house_id):
    house = House.query.get_or_404(house_id)

    # åŸºäºåŒºåŸŸ+ä»·æ ¼+ç§Ÿèµç±»å‹æ¨è
    similar = House.query.filter(
        House.district == house.district,
        House.rental_type == house.rental_type,
        House.price.between(house.price * 0.8, house.price * 1.2),
        House.id != house.id
    ).limit(10).all()

    return jsonify([{
        'id': h.id,
        'title': h.title,
        'price': h.price,
        'area': h.area,
        'district': h.district,
        'image_url': h.image_url
    } for h in similar])
```

### 3. åœ°å›¾æ‰¾æˆ¿ï¿½ï¿½
**ç•Œé¢å±•ç¤º**
![åœ°å›¾æ‰¾æˆ¿é¡µ1](images/screenshots/map-screenshot-1.png)
![åœ°å›¾æ‰¾æˆ¿é¡µ2](images/screenshots/map-screenshot-2.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **å¤šç§å®šä½æ–¹å¼**:
  - ç‚¹å‡»åœ°å›¾å®šä½
  - æœç´¢æ¡†åœ°å€æœç´¢
  - æµè§ˆå™¨è‡ªåŠ¨å®šä½
  - æ‰‹åŠ¨è¾“å…¥åæ ‡
- **æˆ¿æºå¯è§†åŒ–**:
  - èšåˆæ ‡è®°æ˜¾ç¤ºï¼ˆMarkerClustererï¼‰
  - çƒ­åŠ›å›¾æ¨¡å¼åˆ‡æ¢
  - å®æ—¶æˆ¿æºæ ‡è®°æ›´æ–°
- **æ™ºèƒ½ç­›é€‰**:
  - åŠå¾„ç­›é€‰ï¼ˆ500m-5kmï¼‰
  - ä»·æ ¼åŒºé—´ç­›é€‰
  - æˆ¿å‹ç­›é€‰
  - ç§Ÿèµç±»å‹ç­›é€‰
- **ä¾§æ æˆ¿æºåˆ—è¡¨**:
  - å®æ—¶æ›´æ–°é™„è¿‘æˆ¿æº
  - å¤šç§æ’åºæ–¹å¼ï¼ˆè·ç¦»ã€ä»·æ ¼ã€é¢ç§¯ï¼‰
  - æˆ¿æºå¡ç‰‡é¢„è§ˆ

**åæ ‡è½¬æ¢ç®—æ³•**
```javascript
// BD-09 è½¬ GCJ-02
function bdToGcj(bd_lat, bd_lng) {
    const x = bd_lng - 0.0065, y = bd_lat - 0.006;
    const z = Math.sqrt(x * x + y * y) - 0.00002 * Math.sin(y * x_pi);
    const theta = Math.atan2(y, x) - 0.000003 * Math.cos(x * x_pi);
    return {
        lat: z * Math.sin(theta),
        lng: z * Math.cos(theta)
    };
}
```

**é™„è¿‘æˆ¿æºAPI**
```python
@app.route('/api/nearby-houses')
def nearby_houses():
    lat = float(request.args.get('lat'))
    lng = float(request.args.get('lng'))
    radius = float(request.args.get('radius', 2.0))

    # 1. è®¡ç®—è¾¹ç•Œæ¡†
    bounds = get_nearby_bounds(lat, lng, radius)

    # 2. é¢„ç­›é€‰å€™é€‰æˆ¿æº
    candidates = House.query.filter(
        House.latitude.between(bounds['min_lat'], bounds['max_lat']),
        House.longitude.between(bounds['min_lng'], bounds['max_lng'])
    ).limit(100).all()

    # 3. ç²¾ç¡®è·ç¦»è®¡ç®—
    nearby_houses = []
    for house in candidates:
        distance = calculate_distance(lat, lng, house.latitude, house.longitude)
        if distance <= radius:
            house.distance = distance
            house.distance_text = format_distance(distance)
            nearby_houses.append(house)

    # 4. æŒ‰è·ç¦»æ’åº
    nearby_houses.sort(key=lambda x: x.distance)

    return jsonify([house_to_dict(h) for h in nearby_houses[:20]])
```

### 4. ç”¨æˆ·æ³¨å†Œ/ç™»å½•é¡µ
**ç•Œé¢å±•ç¤º**
![ç”¨æˆ·ç™»å½•é¡µ](images/screenshots/login-screenshot.png)
![ç”¨æˆ·æ³¨å†Œé¡µ](images/screenshots/register-screenshot.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **ç”¨æˆ·æ³¨å†Œ**:
  - ç”¨æˆ·å/é‚®ç®±éªŒè¯
  - å¯†ç å¼ºåº¦æ£€æŸ¥
  - é˜²é‡å¤æ³¨å†ŒéªŒè¯
- **ç”¨æˆ·ç™»å½•**:
  - å¯†ç å“ˆå¸ŒéªŒè¯
  - ä¼šè¯ç®¡ç†
  - è®°ä½ç™»å½•çŠ¶æ€
- **å®‰å…¨ç‰¹æ€§**:
  - CSRFä¿æŠ¤
  - å¯†ç åŠ å¯†å­˜å‚¨
  - ç™»å½•å¤±ï¿½ï¿½é™åˆ¶

**ç”¨æˆ·ç³»ç»Ÿå®ç°**
```python
@app.route('/register', methods=['GET', 'POST'])
def register():
    if request.method == 'POST':
        username = request.form.get('username')
        password = request.form.get('password')

        # æ£€æŸ¥ç”¨æˆ·åæ˜¯å¦å·²å­˜åœ¨
        if User.query.filter_by(username=username).first():
            flash('ç”¨æˆ·åå·²å­˜åœ¨')
            return redirect(url_for('register'))

        # åˆ›å»ºæ–°ç”¨æˆ·
        user = User(username=username)
        user.set_password(password)
        db.session.add(user)
        db.session.commit()

        flash('æ³¨å†ŒæˆåŠŸï¼Œè¯·ç™»å½•')
        return redirect(url_for('login'))

    return render_template('register.html')
```

### 5. ç”¨æˆ·ä¸­å¿ƒé¡µ
**ç•Œé¢å±•ç¤º**
![ç”¨æˆ·ä¸­å¿ƒé¡µ](images/screenshots/profile-screenshot.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **ä¸ªäººä¿¡æ¯ç®¡ç†**:
  - ä¿®æ”¹ç”¨æˆ·èµ„æ–™
  - æ›´æ”¹å¯†ç 
  - å¤´åƒä¸Šä¼ 
- **æ”¶è—ç®¡ç†**:
  - æ”¶è—æˆ¿æºåˆ—è¡¨
  - æ‰¹é‡å–æ¶ˆæ”¶è—
  - æ”¶è—æˆ¿æºæ’åº
- **æµè§ˆå†å²**:
  - å†å²æµè§ˆè®°å½•
  - æ¸…ç©ºå†å²è®°å½•
  - å†å²æˆ¿æºç­›é€‰

### 6. æ”¶è—å¤¹é¡µé¢
**ç•Œé¢å±•ç¤º**
![æ”¶è—å¤¹é¡µé¢](images/screenshots/favorites-screenshot.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **æ”¶è—æˆ¿æºç®¡ç†**:
  - æ”¶è—åˆ—è¡¨å±•ç¤º
  - æ‰¹é‡æ“ä½œï¼ˆåˆ é™¤ã€æ’åºï¼‰
  - æ”¶è—æ—¶é—´æ˜¾ç¤º
- **å¿«é€Ÿç­›é€‰**:
  - æŒ‰åŒºåŸŸç­›é€‰æ”¶è—
  - æŒ‰ä»·æ ¼åŒºé—´ç­›é€‰
  - æŒ‰æˆ¿å‹ç­›é€‰

### 7. æµè§ˆå†å²é¡µé¢
**ç•Œé¢å±•ç¤º**
![æµè§ˆå†å²é¡µé¢](images/screenshots/history-screenshot.png)

**æ ¸å¿ƒåŠŸèƒ½**
- **å†å²è®°å½•ç®¡ç†**:
  - æŒ‰æ—¶é—´æ’åºçš„æµè§ˆå†å²
  - å†å²æˆ¿æºå¿«é€Ÿè®¿é—®
  - æ‰¹é‡æ¸…ç†å†å²è®°å½•
- **æ™ºèƒ½æ¨è**:
  - åŸºäºæµè§ˆå†å²çš„æ¨è
  - ç›¸ä¼¼æˆ¿æºäºŒæ¬¡æ¨é€

**å†å²è®°å½•å®ç°**
```python
@app.route('/api/browse-history')
def browse_history():
    if 'user_id' not in session:
        return jsonify({'error': 'è¯·å…ˆç™»å½•'}), 401

    user_id = session['user_id']
    history = BrowseHistory.query.filter_by(user_id=user_id)\
        .order_by(BrowseHistory.created_at.desc())\
        .limit(50).all()

    return jsonify([{
        'id': h.house.id,
        'title': h.house.title,
        'price': h.house.price,
        'area': h.house.area,
        'viewed_at': h.created_at.strftime('%Y-%m-%d %H:%M'),
        'image_url': h.house.image_url
    } for h in history])
```

## ğŸ”§ é«˜çº§åŠŸèƒ½æ¨¡å—

### 1. æ•°æ®å¯è§†åŒ–æ¨¡å—
**åŠŸèƒ½æè¿°**
- æˆ¿æºä»·æ ¼åˆ†å¸ƒå›¾è¡¨
- åŒºåŸŸæˆ¿æºå¯†åº¦çƒ­åŠ›å›¾
- æˆ¿å‹åˆ†å¸ƒé¥¼å›¾
- ä»·æ ¼è¶‹åŠ¿åˆ†æå›¾

**å®ç°æŠ€æœ¯**
```python
@app.route('/api/house-charts/<int:house_id>')
def house_charts(house_id):
    house = House.query.get_or_404(house_id)

    # åŒºåŸŸä»·æ ¼åˆ†æ
    district_prices = db.session.query(
        House.district,
        func.avg(House.price).label('avg_price')
    ).filter(House.district == house.district).all()

    # æˆ¿å‹åˆ†å¸ƒåˆ†æ
    house_types = db.session.query(
        House.house_type,
        func.count(House.id).label('count')
    ).filter(House.district == house.district).all()

    return jsonify({
        'district_prices': [{'district': d[0], 'price': float(d[1])} for d in district_prices],
        'house_types': [{'type': h[0], 'count': h[1]} for h in house_types]
    })
```

### 2. æœç´¢å¼•æ“ä¼˜åŒ–
**åŠŸèƒ½ç‰¹æ€§**
- URLå‹å¥½åŒ–
- Metaæ ‡ç­¾ä¼˜åŒ–
- ç»“æ„åŒ–æ•°æ®æ ‡è®°
- ç«™ç‚¹åœ°å›¾è‡ªåŠ¨ç”Ÿæˆ

**SEOä¼˜åŒ–å®ç°**
```python
@app.route('/f/<district>/<int:price_min>-<int:price_max>')
def seo_filter(district, price_min, price_max):
    # SEOå‹å¥½çš„URLç»“æ„
    query = House.query.filter(
        House.district == district,
        House.price.between(price_min, price_max)
    )

    # ç”ŸæˆSEOå…ƒæ•°æ®
    meta_title = f"{district}æˆ¿æº {price_min}-{price_max}å…ƒ"
    meta_description = f"æœ€æ–°{district}æˆ¿æºä¿¡æ¯ï¼Œä»·æ ¼{price_min}-{price_max}å…ƒï¼Œå…±{query.count()}å¥—"

    return render_template('index.html',
                         houses=query.paginate(1, 20),
                         meta_title=meta_title,
                         meta_description=meta_description)
```

### 3. ç¼“å­˜ç³»ç»Ÿ
**åŠŸèƒ½ç‰¹æ€§**
- Redisç¼“å­˜çƒ­é—¨æˆ¿æº
- æ•°æ®åº“æŸ¥è¯¢ç»“æœç¼“å­˜
- é™æ€èµ„æºCDNç¼“å­˜
- APIå“åº”ç¼“å­˜

**ç¼“å­˜å®ç°**
```python
from flask_caching import Cache

cache = Cache(app, config={'CACHE_TYPE': 'redis'})

@app.route('/api/hot-houses')
@cache.cached(timeout=300)  # ç¼“å­˜5åˆ†é’Ÿ
def hot_houses():
    # çƒ­é—¨æˆ¿æºé€»è¾‘
    hot_houses = House.query.order_by(House.view_count.desc()).limit(20).all()
    return jsonify([house_to_dict(h) for h in hot_houses])
```

### 4. æ—¥å¿—ä¸ç›‘æ§ç³»ç»Ÿ
**åŠŸèƒ½ç‰¹æ€§**
- ç”¨æˆ·è¡Œä¸ºæ—¥å¿—
- ç³»ç»Ÿæ€§èƒ½ç›‘æ§
- é”™è¯¯æ—¥å¿—è®°å½•
- è®¿é—®ç»Ÿè®¡åˆ†æ

**æ—¥å¿—å®ç°**
```python
import logging
from datetime import datetime

# é…ç½®æ—¥å¿—
logging.basicConfig(
    filename='app.log',
    level=logging.INFO,
    format='%(asctime)s %(levelname)s: %(message)s'
)

@app.before_request
def log_request():
    user_id = session.get('user_id', 'anonymous')
    ip = request.environ.get('HTTP_X_FORWARDED_FOR', request.remote_addr)
    logging.info(f"Request: {request.method} {request.path} - User: {user_id} - IP: {ip}")
```

### 5. é‚®ä»¶é€šçŸ¥ç³»ç»Ÿ
**åŠŸèƒ½ç‰¹æ€§**
- æ–°æˆ¿æºé‚®ä»¶æé†’
- æ”¶è—æˆ¿æºé™ä»·é€šçŸ¥
- ç”¨æˆ·æ³¨å†ŒéªŒè¯é‚®ä»¶
- å¯†ç é‡ç½®é‚®ä»¶

**é‚®ä»¶æœåŠ¡å®ç°**
```python
from flask_mail import Mail, Message

mail = Mail(app)

def send_price_drop_notification(user_email, house_info):
    msg = Message(
        'æ”¶è—æˆ¿æºé™ä»·æé†’',
        sender='noreply@rentalhouse.com',
        recipients=[user_email]
    )
    msg.body = f"""
    æ‚¨æ”¶è—çš„æˆ¿æº {house_info['title']} å·²é™ä»·ï¼
    åŸä»·ï¼š{house_info['old_price']}å…ƒ
    ç°ä»·ï¼š{house_info['new_price']}å…ƒ
    é“¾æ¥ï¼š{house_info['url']}
    """
    mail.send(msg)
```

### 6. æ•°æ®å¯¼å…¥å¯¼å‡ºç³»ç»Ÿ
**åŠŸèƒ½ç‰¹æ€§**
- Excelæˆ¿æºæ•°æ®å¯¼å…¥
- CSVæ ¼å¼æ•°æ®å¯¼å‡º
- æ•°æ®æ ¼å¼éªŒè¯
- æ‰¹é‡æ“ä½œå¤„ç†

**æ•°æ®å¤„ç†å®ç°**
```python
import pandas as pd

@app.route('/admin/import-houses', methods=['POST'])
def import_houses():
    if 'file' not in request.files:
        return jsonify({'error': 'è¯·é€‰æ‹©æ–‡ä»¶'}), 400

    file = request.files['file']
    if file.filename.endswith('.xlsx'):
        df = pd.read_excel(file)

        for index, row in df.iterrows():
            house = House(
                title=row['æ ‡é¢˜'],
                price=row['ä»·æ ¼'],
                area=row['é¢ç§¯'],
                district=row['åŒºåŸŸ'],
                # å…¶ä»–å­—æ®µ...
            )
            db.session.add(house)

        db.session.commit()
        return jsonify({'message': f'æˆåŠŸå¯¼å…¥{len(df)}æ¡æˆ¿æºæ•°æ®'})

    return jsonify({'error': 'ä»…æ”¯æŒExcelæ–‡ä»¶æ ¼å¼'}), 400
```

### 7. ç§»åŠ¨ç«¯é€‚é…
**æŠ€æœ¯ç‰¹æ€§**
- å“åº”å¼å¸ƒå±€è®¾è®¡
- è§¦å±æ‰‹åŠ¿æ”¯æŒ
- PWAç¦»çº¿åŠŸèƒ½
- ç§»åŠ¨ç«¯æ€§èƒ½ä¼˜åŒ–

**ç§»åŠ¨ç«¯ä¼˜åŒ–**
```javascript
// ç§»åŠ¨ç«¯é€‚é…ä»£ç 
if (window.innerWidth <= 768) {
    // ç§»åŠ¨ç«¯ç‰¹æœ‰åŠŸèƒ½
    document.body.classList.add('mobile-view');

    // æ·»åŠ è§¦æ‘¸æ‰‹åŠ¿æ”¯æŒ
    let touchStartX = 0;
    let touchEndX = 0;

    document.addEventListener('touchstart', e => {
        touchStartX = e.changedTouches[0].screenX;
    });

    document.addEventListener('touchend', e => {
        touchEndX = e.changedTouches[0].screenX;
        handleSwipe();
    });
}
```

### 8. å®‰å…¨é˜²æŠ¤ç³»ç»Ÿ
**å®‰å…¨ç‰¹æ€§**
- SQLæ³¨å…¥é˜²æŠ¤
- XSSæ”»å‡»é˜²æŠ¤
- CSRFä»¤ç‰ŒéªŒè¯
- APIè®¿é—®é¢‘ç‡é™åˆ¶
- ç”¨æˆ·æƒé™æ§åˆ¶

**å®‰å…¨å®ç°**
```python
from flask_limiter import Limiter
from flask_limiter.util import get_remote_address

limiter = Limiter(app, key_func=get_remote_address)

@app.route('/api/nearby-houses')
@limiter.limit("100 per minute")  # APIè®¿é—®é¢‘ç‡é™åˆ¶
def nearby_houses():
    # APIå®ç°...
    pass

# XSSé˜²æŠ¤
from markupsafe import escape

@app.template_filter('safe_html')
def safe_html(text):
    return escape(text)
```

## ğŸ¯ æ ¸å¿ƒç®—æ³•ä¸æŠ€æœ¯äº®ç‚¹

### 1. é™„è¿‘æˆ¿æºç®—æ³•
```python
# è¾¹ç•Œæ¡†é¢„ç­›é€‰ + ç»çº¬å·®æ’åº + å€™é€‰é›†é™åˆ¶ + Haversineç²¾ç®—
def get_nearby_houses(lat, lng, radius_km, limit=20):
    # 1. è®¡ç®—è¾¹ç•Œæ¡†
    bounds = get_nearby_bounds(lat, lng, radius_km)
    # 2. é¢„ç­›é€‰å€™é€‰æˆ¿æº
    candidates = House.query.filter(
        House.latitude.between(bounds['min_lat'], bounds['max_lat']),
        House.longitude.between(bounds['min_lng'], bounds['max_lng'])
    ).limit(limit * 5).all()
    # 3. ç²¾ç¡®è·ç¦»è®¡ç®—ä¸æ’åº
    return sorted(candidates, key=lambda h: calculate_distance(lat, lng, h.latitude, h.longitude))[:limit]
```

### 2. åæ ‡ç³»è½¬æ¢
- **BD-09åæ ‡ç³»**: ç™¾åº¦åœ°å›¾ä¸“ç”¨
- **GCJ-02åæ ‡ç³»**: å›½æµ‹å±€åæ ‡ç³»ï¼Œé«˜å¾·/è…¾è®¯åœ°å›¾ä½¿ç”¨
- **ç»Ÿä¸€è½¬æ¢**: å‰ç«¯è°ƒç”¨APIå‰è‡ªåŠ¨è½¬æ¢åæ ‡ç³»ï¼Œç¡®ä¿è®¡ç®—å‡†ç¡®æ€§

### 3. åœ°å›¾èšåˆå±•ç¤º
- **MarkerClusterer**: å¤§é‡æˆ¿æºæ ‡è®°èšåˆï¼Œæå‡æ¸²æŸ“æ€§èƒ½
- **çƒ­åŠ›å›¾æ¨¡å¼**: ç›´è§‚å±•ç¤ºæˆ¿æºå¯†åº¦åˆ†å¸ƒ
- **å®æ—¶æ›´æ–°**: ä¾§æ æˆ¿æºåˆ—è¡¨ä¸åœ°å›¾æ ‡è®°è”åŠ¨

## ğŸ“Š æ•°æ®è§„æ¨¡

- **æˆ¿æºæ€»é‡**: 113,318æ¡çœŸå®æˆ¿æºæ•°æ®
- **è¦†ç›–åŒºåŸŸ**: ä¸»è¦åŸå¸‚æ ¸å¿ƒåŒºåŸŸ
- **æ•°æ®å­—æ®µ**: ä½ç½®ã€ä»·æ ¼ã€é¢ç§¯ã€æˆ¿å‹ã€é…å¥—è®¾æ–½ç­‰30+å­—æ®µ
- **æ›´æ–°é¢‘ç‡**: æ”¯æŒæ‰¹é‡åœ°ç†ç¼–ç ä¸æ•°æ®æ›´æ–°

## ğŸš€ éƒ¨ç½²æ–¹å¼

### å¼€å‘ç¯å¢ƒéƒ¨ç½²
```bash
# 1. å…‹éš†é¡¹ç›®
git clone [repository-url]
cd rental-house-platform

# 2. ç¯å¢ƒé…ç½®
conda create -n rental-house python=3.9
conda activate rental-house
pip install -r requirements.txt

# 3. æ•°æ®åº“åˆå§‹åŒ–
# è¿è¡Œ setup_mysql.bat æˆ–æ‰‹åŠ¨å¯¼å…¥
mysql -u root -p < house.sql

# 4. å¯åŠ¨åº”ç”¨
python app.py
# æˆ–ä½¿ç”¨ start.bat
```

### ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²
```bash
# PyInstaller æ‰“åŒ…
pyinstaller map_house.spec

# è¿è¡Œæ‰“åŒ…åçš„ç¨‹åº
cd dist/map_house
./map_house.exe
```

## ğŸ› å¸¸è§é—®é¢˜è§£å†³

| é—®é¢˜ç±»å‹ | è§£å†³æ–¹æ¡ˆ |
|---------|---------|
| MySQLè¿æ¥å¤±è´¥(1045) | æ£€æŸ¥MySQLæœåŠ¡çŠ¶æ€ï¼Œä¿®æ”¹config.jsonä¸­çš„æ•°æ®åº“é…ç½® |
| æˆ¿æºæ•°æ®ä¸ºç©º | é‡æ–°æ‰§è¡Œsetup_mysql.batå¯¼å…¥æ•°æ® |
| åœ°å›¾ä¸æ˜¾ç¤º | æ£€æŸ¥ç™¾åº¦åœ°å›¾API Keyé…ç½®å’Œç½‘ç»œè¿æ¥ |
| åæ ‡åç§» | ç¡®è®¤BD-09ä¸GCJ-02åæ ‡ç³»è½¬æ¢æ­£ç¡®æ€§ |

## ğŸ“ˆ æ€§èƒ½ä¼˜åŒ–

- **æ•°æ®åº“ç´¢å¼•**: å…³é”®å­—æ®µå»ºç«‹å¤åˆç´¢å¼•ï¼ŒæŸ¥è¯¢æ€§èƒ½æå‡80%
- **åˆ†é¡µåŠ è½½**: é¦–é¡µæˆ¿æºåˆ—è¡¨åˆ†é¡µå±•ç¤ºï¼Œå‡å°‘åˆå§‹åŠ è½½æ—¶é—´
- **åæ ‡ç¼“å­˜**: åœ°ç†ç¼–ç ç»“æœç¼“å­˜ï¼Œé¿å…é‡å¤è®¡ç®—
- **é™æ€èµ„æº**: CSS/JSå‹ç¼©ä¸ç‰ˆæœ¬æ§åˆ¶ï¼Œä¼˜åŒ–åŠ è½½é€Ÿåº¦

## ğŸ‘¨â€ğŸ’» ä½œè€…ä¸è´¡çŒ®è€…

### ä¸»è¦å¼€å‘è€…
- **[net643397-dot](https://github.com/net643397-dot)** - é¡¹ç›®åˆ›å»ºè€…ï¼Œæ ¸å¿ƒåŠŸèƒ½å¼€å‘
  - ğŸ—ï¸ **ä¸»è¦è´¡çŒ®**: åç«¯æ¶æ„è®¾è®¡ã€åœ°å›¾æ‰¾æˆ¿åŠŸèƒ½ã€ç”¨æˆ·ç³»ç»Ÿã€æ€§èƒ½ä¼˜åŒ–
  - ğŸ’» **æŠ€æœ¯æ ˆ**: Flask, MySQL, JavaScript, ç™¾åº¦åœ°å›¾API
  - ğŸ“… **å¼€å‘æ—¶é—´**: 2025å¹´9æœˆ20æ—¥ - 10æœˆ12æ—¥ (4ä¸ªå·¥ä½œæ—¥)

### è´¡çŒ®ç»Ÿè®¡
- **ä»£ç è¡Œæ•°**: 11,743+ è¡Œ
- **åŠŸèƒ½æ¨¡å—**: 15ä¸ªä¸»è¦æ¨¡å—
- **APIæ¥å£**: 20+ ä¸ªRESTfulæ¥å£
- **æ•°æ®åº“**: 113,318æ¡çœŸå®æˆ¿æºæ•°æ®

## ğŸ¤ è´¡çŒ®æŒ‡å—

æ¬¢è¿å¯¹æœ¬é¡¹ç›®åšå‡ºè´¡çŒ®ï¼è¯·éµå¾ªä»¥ä¸‹æ­¥éª¤ï¼š

1. **Fork** æœ¬ä»“åº“åˆ°ä½ çš„GitHubè´¦æˆ·
2. **åˆ›å»º** ç‰¹æ€§åˆ†æ”¯ (`git checkout -b feature/AmazingFeature`)
3. **æäº¤** æ›´æ”¹ (`git commit -m 'Add some AmazingFeature'`)
4. **æ¨é€** åˆ°åˆ†æ”¯ (`git push origin feature/AmazingFeature`)
5. **æ‰“å¼€** Pull Request

### è´¡çŒ®ç±»å‹
- ğŸ› **Bugä¿®å¤**: ä¿®å¤å·²çŸ¥é—®é¢˜
- âœ¨ **æ–°åŠŸèƒ½**: æ·»åŠ æ–°çš„åŠŸèƒ½ç‰¹æ€§
- ğŸ“š **æ–‡æ¡£**: æ”¹è¿›æ–‡æ¡£å’Œè¯´æ˜
- ğŸ¨ **UI/UX**: ç•Œé¢å’Œç”¨æˆ·ä½“éªŒä¼˜åŒ–
- âš¡ **æ€§èƒ½**: æ€§èƒ½ä¼˜åŒ–å’Œæ”¹è¿›
- ğŸ”§ **å·¥å…·**: å¼€å‘å·¥å…·å’Œè„šæœ¬

## ğŸ“ è®¸å¯è¯

æœ¬é¡¹ç›®é‡‡ç”¨ MIT è®¸å¯è¯ - æŸ¥çœ‹ [LICENSE](LICENSE) æ–‡ä»¶äº†è§£è¯¦æƒ…

## ğŸ“ è”ç³»æ–¹å¼

- **é¡¹ç›®ä½œè€…**: [net643397-dot](https://github.com/net643397-dot)
- **é¡¹ç›®æ—¶é—´**: 2025å¹´9æœˆ20æ—¥-10æœˆ12æ—¥
- **å¼€å‘å‘¨æœŸ**: 4ä¸ªå·¥ä½œæ—¥

---

â­ å¦‚æœè¿™ä¸ªé¡¹ç›®å¯¹ä½ æœ‰å¸®åŠ©ï¼Œè¯·ç»™å®ƒä¸€ä¸ªæ˜Ÿæ ‡ï¼

**ç‰ˆæœ¬**: v2.0 | **æœ€åæ›´æ–°**: 2025-10-12 | **çŠ¶æ€**: ç”Ÿäº§å°±ç»ª
